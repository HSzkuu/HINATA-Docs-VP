# 更新日志

## HINATA & HINATA Lite 2025100121-af106a7b
* 修复了潜在的无法启动的问题

## HINATA & HINATA Lite 2025093016-d770c302
* 兼容了 バンダイナムコ (Bandai Namco) 游戏的原生协议（湾岸，太鼓达人，高达等）
* 将 `PN532 直通模式` 和 `バンダイナムコ原生协议` 下放给 HINATA Lite
* 增添了低功耗模式，电脑关机时会关闭射频模块和LED灯，电脑开机时会自动恢复
* 修复 2025040400 中造成的 `SEGA串口协议` 偶尔会连接失败需要重新插拔的问题
* 优化上电时默认的彩虹灯光效果，并提供了固定灯效模式可供后续调节
* `SEGA串口协议` 中的灯光亮度调整回归
* 预留了一些设置项，供后续 HINATA Control Center 使用

## HINATA & HINATA Lite 2025052505-40e67bd6
* 上个版本有一行测试代码忘了删（ 可能会导致sega串口模式下工作异常

## HINATA & HINATA Lite 2025052106-3915f44d
* 修复PN532直通模式异常的问题
* 修复aimeio在放置时偶发的包错误
* (上面两条是因为昨天的更新并没有完全解决) 
* 初步加入了多卡选择

## HINATA & HINATA Lite 2025052019-b75d2083
* 修复PN532直通模式异常的问题
* 修复aimeio下在放置时偶发性发包出错的问题

## HINATA & HINATA Lite 2025051301-c4fea99b

* 重构部分模块
* 修复部分特殊sak卡片不能刷的问题
* 实现了sega游戏的thincaled指令
* 优化刷卡速度和稳定性
* 优化了iPhone的pasmo读取成功率
* 为后续控制中心的使用预留了更多接口
* 上电后的灯效修改为彩虹灯，如果检测到卡片就会提高亮度


## HINATA & HINATA Lite 2025040400

2025/4/4：  
重构后的读卡器固件:  
目前支持了：  
读取可能会比之前更稳定的 SEGA 官方协议  
颠覆性的全新 AimeIO  
给 Konami 游戏和太鼓达人用的 CardIO ( 标准版 Only )  
全自动的 PN532 直通 ( 标准版 Only )  
以后的固件更新将全变为web端在线更新  
Todo:  
Bandai Namco 原生协议  
新控制中心待完善  
全新的 AimeIO:  
向下兼容旧版固件，并且现在可以和回车刷卡共存了!!  

用2025年新版固件才会有的独家新功能：  
众所周知，Amusement IC 的卡号正常情况下需要将卡片序列号发送给游戏服务器，然后服务器返回卡号。  
但是许多服务器并不兼容这个东西，会导致玩家刷到的卡号变成 0008 开头的序列号转换出来的卡号   
于是就有了现在这一版 AimeIO，绕过服务器，直接将 Amusement IC 卡片背后卡号发送给游戏，可以确保你在任何服务器都可以读取到正确的卡号。  
Mac 和 Linux 用户可以访问 https://cc.neri.moe 更新固件，  
Windows 用户需要下载群文件内的固件包更新  


## HINATA-2024093002

2024/9/30:
重写SEGA串口接包逻辑，再次修复游戏尝试更新读卡器固件的问题。
传入游戏的hw/fw版本修改为837-15396 94

2024/9/28:
这次真的修了游戏刷固件bug，由于没有其他更改，所以这次版本叫做2024091401

2024/9/14:
修复SEGA游戏进test时会不断尝试给读卡器刷固件的bug
增加了全局的低功耗模式，10分钟内如果没有读取到任何卡片并且没有连接到任何游戏时就会开启，连接到游戏或读取到卡片时就会自动关闭
SEGA串口模式增加了多卡选择，暂不开放，未来开放使用

## HINATA-2024090500

2024/9/5:
在读卡器通电时会亮黄色灯光，USB握手成功后才会渐变为蓝色灯光，可以直观判断读卡器有没有成功连接到电脑
再次优化模式切换逻辑
修复aimeio的dll在部分segatools中被拒绝的问题
压缩包内放了个更旧方式的更新脚本，给老固件用

## HINATA-2024090400

2024/9/4：
修复cardio工作不正常的问题

## HINATA-2024090300

**有 Bug，请谨慎刷入**

2024/9/3：
由于已经实现了官方读卡器完整的所有读卡逻辑，现在暂时删除Felica兼容模式(把各类Felica卡伪装为Felica Lite-S来骗过游戏)
底层屏蔽掉了sak20的标签（因为会影响Mobile Felica）。现在刷Pixel以及各类日版机的Mobile Felica应该可以更加稳定。

2024/9/2.2:
优化实现扩展安全验证后的felica卡读卡速度

## HINATA-2024090201

**有 Bug，请谨慎刷入**

2024/9/2.1:
修复了9月2日固件引入的无法读卡的bug

2024/9/2:
实现了官方读卡器的额外校验，现在可以让游戏直接连接官服aimedb刷卡了
（代码部分地方做了大改，有可能会不稳定）

2024/8/31:
今天是初音未来女士33岁生日 祝她生日快乐
正式支持了aimeio，虽然旧版固件也能用我的aimeio，但是有点小bug，于是先把这个固件发出来了

aimeio下读卡器可以在游戏内热插拔，读卡器拔掉以后也不会断网，也可以随时插回去，并且可以在segatools.ini中调整灯光亮度。
即插即用，不需要和Windows斗智斗勇来设置端口号
aimeio相对于 原生串口协议 来说对头文字D之类或者其他小众sega游戏支持较好

aimeio下暂不支持旧版banapass(非Amusement IC版本的)
并且由于segatools有些抽象实现，导致aimeio下可能在某些实现了官方aimedb的服务器刷四社卡后卡号依然不对，RIN服已经联系解决，其他服请自求多福（
如果你用的是aqua/artemis本地服，或者是鹿网，nageki网之类的没有实现官方aimedb的服务器，对你没有影响

建议优先使用原生协议模式（串口）

再次优化全自动模式切换逻辑
为下一代控制中心做了些预留api

## HINATA-2024050400

2024/5/4：
控制中心内读卡时点击可以一键复制卡号
在HINATA上电后不需要绑定灯光就可以使用CardIO，但如果上电后启动过SEGA游戏，就需要绑定灯光，或者重新插拔读卡器。
现在在太鼓上应该不会刷一次卡就炸游戏了。
修复了spicecfg的 Analog 选项卡中会显示HINATA的bug。
控制中心内读卡速度优化

2024/5/2：
！该版本各种意义上都改动较大，如果遇到以前没有遇到过的bug请回退版本
！控制中心请不要沿用旧版的config.json
优化了CardIO和SEGA串口的切换逻辑
修复了spicecfg中会显示两个HINATA的bug
修复了控制中心在启动时不会向读卡器同步设置的bug
删除了控制中心中的 Felica兼容模式 按钮，改为默认开启
Cardio现在可以读取Aime卡的Access Code了，而非UID（为了兼容以前的用户的账号，该功能默认关闭）
控制中心中添加了调整cardio设置的页面：M1卡UID读取（默认开启），[new]Aime卡Access Code读取(默认关闭)
